![](/_assets/svchost.exe.Locky/About.png)

# Static Analysis with Ghidra


Focusing on some interesting API calls related to the Registry.
![](/_assets/svchost.exe.Locky/RegAPIs.png)

RegOpenKeyExA first shows the RUN key being opened. hKey is the first parameter taken by RegOpenKeyExA and it represents the handle of the Registry key to open.  In this case it shows  0x80000001 which is HKEY_CURRENT_USER. LpSubKey is the name of the registry subkey to be opened. In this case its the Run key under CurrentVersion (Shown in decompiled view).  This is a persistence mechanism for the malware.
![](/_assets/svchost.exe.Locky/RunKey.png)

![](/_assets/svchost.exe.Locky/RunKey2.png)

RegCreateKeyExA gives some insight to what malware family this may be from.  The same hKey is referenced for HKEY_CURRENT_USER and it is adding a key Software\\Locky.
![](/_assets/svchost.exe.Locky/LockyKey.png)

